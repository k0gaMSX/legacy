MGSDRV version 3.17	Copyright(c) 1991-93 by Ain

★ MGSDRVとは

　MGSDRVはPSG,FM,SCC音源を最大17音まで演奏出来るMusicドライバです。v2.xxまで
のMGSDRVとは違い、基本的にデータを演奏する事しか行ないませんので、これだけで
は曲データを作成したり演奏を聞くことはできません。

★ 使用方法

  DOS1上では常駐が出来ず、他のプログラム(MGSEL,MGSC等)がオーバーレイとして
読み込むだけですので実行する意味はほとんどありません(バージョン番号が確認
出来る位)。DOS2では以下に示すオプションが使用できます。

　/Z .... ドライバを常駐、開放します。常駐時には最低32kバイトの空きマッパ
	  RAM(プライマリ以外は不可)が必要です。オプションの後に実行するDO
	  Sコマンドが指定できます。指定が無い場合、REBOOT.BATが実行(あれば
	  )されます。なおオプションは左から解釈、実行されますのでこのオプ
	  ションは一番最後(右端)に書くようにしてください。

　/Dx ... ブートドライブを設定します。この指定はMGSDRVがDOSをリブートする時
	  だけでなく、以降のリブートでも有効になります(BASICで_SYSTEMを実行
	  した時など)。xはそのままドライブ名(A〜H)を指定します。

  /Sx  .. SCCのスロット番号を強制的に指定します。スロット番号は拡張スロット
          番号(基本スロットの場合は0)×4 + 基本スロット番号を16進数で記述し
          て下さい。このオプションが指定されると、そこがRAMやROMでもSCCと見
          なして処理しますので指定を誤ると暴走する場合があります。

  /Bx  .. 曲データ用セグメントを複数確保します。最大10個まで指定することが出
  	  来ます。このオプションが指定されなくとも自動的に1個確保されます。
  	  /bの後に(確保したいセグメント数)-1を指定して下さい。4つ確保したい
  	  のなら/b3です。/b9(最大)とした時は、16k+160kで176k(11セグメント)必
  	  要です(未改造のFS-A1STでは/B9を指定することは出来ません)。

  /Kx ... キーボードで演奏開始、音量などをコントロールする際にテンキーと一緒
  	  に押されるキーを指定します。無指定の時は[CTRL]になっています。
	  指定可能なキーと、その値は次の通りです。

  	  1...SHIFT	2...CTRL	3...GRAPH

	  SHIFTなら/K1をGRAPHなら/K3を指定します。0で無効に出来ます。

使用例:

・MGSDRV /Z			MGSDRVを常駐(解放)させる。
・MGSDRV /ZAUTOEXE2		MGSDRVを常駐(解放)させた後、AUTOEXE2を実行。
・MGSDRV /DC /Z			ブートドライブをドライブCに変更してから常駐。
				ドライブCのREBOOT.BATが実行されます。
・MGSDRV /S5 /Z			SCCのスロット番号を#1-2に強制指定して、常駐。
・MGSDRV /DB:			ブートドライブをドライブBに変更する。
				常駐はしません。
・MGSDRV /B4 /Z			曲データ用セグメントを5つ確保して常駐。

★ コントロールキーの割り当てについて

  /Kで設定されたキーと、テンキーの以下のキーを押すことにより、いつでも(独自の
  割り込みルーチンを持つものや、割り込みを禁止したまま動作するプログラムを除
  く)演奏開始、音量の操作などが行なえます。

  /    ... 演奏停止
  *    ... 演奏開始
  -    ... 音量を下げる
  +    ... 音量を上げる
  .    ... 演奏中断
  ,    ... 演奏再開
  0〜9 ... 曲データセグメントを指定された番号に切り替える

  これらの処理は割り込みで行なわれるため、プログラムによっては動作しなかった
  り不都合が発生する場合があります。特に演奏開始は処理時間が極端に長いため通
  信ソフトでは文字落ちの原因となります。必ず実行中のプログラムが入力待ちなど
  になっている状態で操作して下さい。

  0〜9を押すと、曲データセグメントが切り替わります(セグメントなんて専門用語
  (笑)を出していますが、この場合曲データを保存しておく領域と思って下さい)。2
  個以上のセグメントを確保している場合はそれぞれのセグメントに曲データをロー
  ドしておいて、それを自由に切り替える事が出来ます(切り替えると必ず演奏が停
  止します)。有効なセグメントでなかった(確保された数を超えている)場合、演奏が
  停止するだけで実際には切り替わりません。切り替える際は、他のキーと同じく実
  行中のプログラムが入力待ちなどになっている状態で行なって下さい。特にMGSDRV
  を使用するほとんどのプログラムは現在のところ、突然セグメントが切り替えられ
  る事を前提に作られていません(突然追加された仕様なので当然ですが)ので、それ
  らのプログラム実行中は細心の注意を払って下さい。

操作例:(mgsdrv /b3 /zとしてセグメントを4個確保した場合)

  (CTRL + [0]を押す)
A>mgsqc ys200	← 適当な曲1
  (CTRL + [1]を押す)
A>mgsqc ys201	← 適当な曲2
  (CTRL + [2]を押す)
A>mgsqc ys202	← 適当な曲3
  (CTRL + [3]を押す)
A>mgsqc ys203	← 適当な曲4

  CTRL + [0]を押すとys200のセグメントへ、
  CTRL + [1]を押すとys201のセグメントへ、
  CTRL + [2]を押すとys202のセグメントへ、
  CTRL + [3]を押すとys203のセグメントへ、
  それぞれ切り替わります。切り替えた後はCTRL + [*]で演奏開始。

★ 注意など

・ブートドライブを変更した場合は、そのドライブにMSXDOS2.SYSとCOMMAND2.COMが
  存在しないと正常にブートしません。カレントドライブはブートしたドライブにな
  ります。
・演奏には割り込みを使用していますので、長時間割り込みを禁止されると(例え
　ばディスクアクセス時)演奏が遅くなったりしますが、異常ではありません。

★ 変更点

・開放時にセグメントが1つだけ残ってしまうバグを修正した。
・若干の高速化。

★ 転載、配布は自由に行なってください。

※ MGSQCはいーた氏が作成されたフリーソフトウェア、
   VMAPは良牙氏が作成されたフリーソフトウェアです。

MARIO NET  :AIN
FALCON NET :FALC0180
NATSUME NET:NAT25667

　Ａｉｎ
